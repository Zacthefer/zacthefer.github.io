<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Chatbot Demo — Isaac Automation Group</title>
  <meta name="description" content="Try our AI chatbot demo powered by Claude. See how an AI assistant can handle customer questions and qualify leads for your business.">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ── API Key Modal ── -->
<div class="overlay hidden" id="key-overlay" role="dialog" aria-modal="true" aria-labelledby="key-title">
  <div class="modal">
    <h2 id="key-title">Configure API Key</h2>
    <p>Enter your Anthropic API key to enable live AI responses. Your key is stored locally in your browser and never sent to our servers.</p>
    <input type="password" id="api-key-input" placeholder="sk-ant-..." autocomplete="off" spellcheck="false">
    <div class="modal-actions">
      <button class="btn btn-primary" id="save-key-btn">Save Key</button>
      <button class="btn btn-secondary" id="cancel-key-btn">Use Demo Mode</button>
    </div>
    <p class="modal-note">No API key? The chatbot will run in demo mode with simulated responses that show what a real deployment looks like.</p>
  </div>
</div>

<!-- ── Header ── -->
<header>
  <div class="container">
    <div class="header-inner">
      <a href="/" class="logo">
        <svg class="logo-icon" width="32" height="32" viewBox="0 0 32 32" fill="none" aria-hidden="true">
          <rect width="32" height="32" rx="8" fill="#111111"/>
          <path d="M8 24L16 9 24 24" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M11 19h10" stroke="white" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <span class="logo-text">
          <span class="logo-name-main">Isaac</span>
          <span class="logo-name-sub">Automation Group</span>
        </span>
      </a>
      <nav>
        <a href="/">Home</a>
        <a href="/#contact" class="btn btn-primary">Book a Call</a>
      </nav>
    </div>
  </div>
</header>

<!-- ── Page Hero ── -->
<div class="demo-header">
  <div class="container">
    <a href="/" class="back-link">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M19 12H5"/><path d="M12 19l-7-7 7-7"/></svg>
      Back to home
    </a>
    <h1>Try Our AI Chatbot</h1>
    <p class="subtitle">Ask it anything about AI automation for small businesses. This is exactly what we build for your customers.</p>
  </div>
</div>

<!-- ── Chat Interface ── -->
<section class="chat-section">
  <div class="container">
    <div class="chat-wrapper">
      <div class="chat-box">

        <!-- Chat header -->
        <div class="chat-top">
          <div class="chat-agent">
            <div class="chat-avatar" aria-hidden="true">
              <svg viewBox="0 0 24 24"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/></svg>
            </div>
            <div>
              <div class="chat-agent-name">IAG Assistant</div>
              <div class="chat-agent-status" id="status-text">Online · Demo Mode</div>
            </div>
          </div>
          <button class="chat-key-btn" id="open-key-btn" title="Configure API Key">⚙ API Key</button>
        </div>

        <!-- Messages -->
        <div class="chat-messages" id="chat-messages" role="log" aria-live="polite" aria-label="Chat messages">
          <div class="msg bot">
            <div class="bubble">Hi! I'm an AI assistant for Isaac Automation Group. Ask me anything about how AI chatbots, voice receptionists, or lead generation systems can help your business. What would you like to know?</div>
          </div>
        </div>

        <!-- Input -->
        <div class="chat-bottom">
          <textarea
            class="chat-input"
            id="chat-input"
            placeholder="Type a message…"
            rows="1"
            aria-label="Type your message"
          ></textarea>
          <button class="send-btn" id="send-btn" aria-label="Send message">
            Send
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M22 2L11 13"/><path d="M22 2L15 22 11 13 2 9l20-7z"/></svg>
          </button>
        </div>

      </div>
    </div>
  </div>
</section>

<!-- ── Contact CTA ── -->
<section class="cta-section">
  <div class="container">
    <h2>Want This on Your Website?</h2>
    <p>We build and deploy custom AI chatbots trained on your business in days. Book a call to see a live example.</p>
    <a href="https://calendly.com/isaacautomationgroup" target="_blank" rel="noopener" class="btn btn-primary">Book a Free Discovery Call</a>
  </div>
</section>

<!-- ── Footer ── -->
<footer>
  <div class="container">
    <div class="footer-inner">
      <span class="footer-copy">© 2025 Isaac Automation Group. Daytona Beach, FL.</span>
      <div class="footer-links">
        <a href="terms.html">Terms</a>
        <a href="privacy.html">Privacy</a>
        <a href="refund.html">Refund</a>
      </div>
    </div>
  </div>
</footer>

<script>
// ── Config ──
const STORAGE_KEY = 'iag_anthropic_key';
const MODEL = 'claude-sonnet-4-6';
const API_URL = 'https://api.anthropic.com/v1/messages';
const SYSTEM_PROMPT = `You are a helpful AI assistant demo for Isaac Automation Group. You help small business owners understand how AI chatbots can answer customer questions, handle FAQs, and qualify leads for their business. Keep responses concise and friendly.`;

// Demo fallback responses (used when no API key is set)
const DEMO_RESPONSES = [
  "Great question! A chatbot like this one can be trained on your specific business — your services, pricing, hours, and FAQs — so it answers like a knowledgeable team member.",
  "Exactly the kind of thing we automate. Your chatbot handles 80% of inbound questions automatically, so you only spend time on serious leads who are ready to book.",
  "For most small businesses, the biggest win is after-hours coverage. Customers get answers at midnight, and you wake up to qualified leads in your inbox.",
  "Setup takes just a few days. We gather your business info, write the prompts, and deploy it on your website. No technical knowledge needed on your end.",
  "The chatbot can also qualify leads by asking a few key questions — like what service they need, their location, and budget — before routing them to you.",
  "Most of our clients see 30–50% fewer missed leads within the first week. The bot never sleeps, never takes a day off, and never forgets to follow up.",
  "Good point! We can integrate the chatbot with your booking system, CRM, or email so everything stays in sync without you lifting a finger.",
];
let demoIndex = 0;

// ── State ──
let conversationHistory = [];
let isLoading = false;

// ── DOM ──
const messagesEl = document.getElementById('chat-messages');
const inputEl = document.getElementById('chat-input');
const sendBtn = document.getElementById('send-btn');
const statusEl = document.getElementById('status-text');
const openKeyBtn = document.getElementById('open-key-btn');
const keyOverlay = document.getElementById('key-overlay');
const apiKeyInput = document.getElementById('api-key-input');
const saveKeyBtn = document.getElementById('save-key-btn');
const cancelKeyBtn = document.getElementById('cancel-key-btn');

// ── Key Management ──
function getKey() { return localStorage.getItem(STORAGE_KEY) || ''; }
function setKey(k) { localStorage.setItem(STORAGE_KEY, k); }

function updateStatus() {
  const key = getKey();
  statusEl.textContent = key ? 'Online · Live AI' : 'Online · Demo Mode';
}
updateStatus();

openKeyBtn.addEventListener('click', () => {
  apiKeyInput.value = getKey();
  keyOverlay.classList.remove('hidden');
  apiKeyInput.focus();
});
saveKeyBtn.addEventListener('click', () => {
  const val = apiKeyInput.value.trim();
  if (val) { setKey(val); updateStatus(); }
  keyOverlay.classList.add('hidden');
});
cancelKeyBtn.addEventListener('click', () => keyOverlay.classList.add('hidden'));
keyOverlay.addEventListener('click', (e) => { if (e.target === keyOverlay) keyOverlay.classList.add('hidden'); });
apiKeyInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') saveKeyBtn.click(); });

// ── UI Helpers ──
function addMessage(role, text) {
  const wrap = document.createElement('div');
  wrap.className = `msg ${role}`;
  const bubble = document.createElement('div');
  bubble.className = 'bubble';
  bubble.textContent = text;
  wrap.appendChild(bubble);
  messagesEl.appendChild(wrap);
  messagesEl.scrollTop = messagesEl.scrollHeight;
  return wrap;
}

function showTyping() {
  const wrap = document.createElement('div');
  wrap.className = 'msg bot';
  wrap.id = 'typing';
  const dots = document.createElement('div');
  dots.className = 'typing-dots';
  dots.innerHTML = '<span></span><span></span><span></span>';
  wrap.appendChild(dots);
  messagesEl.appendChild(wrap);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

function removeTyping() {
  const t = document.getElementById('typing');
  if (t) t.remove();
}

function setLoading(v) {
  isLoading = v;
  sendBtn.disabled = v;
  inputEl.disabled = v;
}

// ── API Call ──
async function callAPI(userMessage) {
  conversationHistory.push({ role: 'user', content: userMessage });
  const key = getKey();

  if (!key) {
    // Demo mode
    await new Promise(r => setTimeout(r, 900 + Math.random() * 600));
    const reply = DEMO_RESPONSES[demoIndex % DEMO_RESPONSES.length];
    demoIndex++;
    conversationHistory.push({ role: 'assistant', content: reply });
    return reply;
  }

  const resp = await fetch(API_URL, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'x-api-key': key,
      'anthropic-version': '2023-06-01',
      'anthropic-dangerous-allow-browser': 'true',
    },
    body: JSON.stringify({
      model: MODEL,
      max_tokens: 512,
      system: SYSTEM_PROMPT,
      messages: conversationHistory,
    }),
  });

  if (!resp.ok) {
    const err = await resp.json().catch(() => ({}));
    throw new Error(err.error?.message || `API error ${resp.status}`);
  }

  const data = await resp.json();
  const reply = data.content[0].text;
  conversationHistory.push({ role: 'assistant', content: reply });
  return reply;
}

// ── Send Handler ──
async function handleSend() {
  const text = inputEl.value.trim();
  if (!text || isLoading) return;

  inputEl.value = '';
  inputEl.style.height = 'auto';
  addMessage('user', text);
  setLoading(true);
  showTyping();

  try {
    const reply = await callAPI(text);
    removeTyping();
    addMessage('bot', reply);
  } catch (err) {
    removeTyping();
    addMessage('bot', 'Sorry, something went wrong. Please check your API key or try again in a moment.');
    console.error(err);
  } finally {
    setLoading(false);
    inputEl.focus();
  }
}

sendBtn.addEventListener('click', handleSend);
inputEl.addEventListener('keydown', (e) => {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    handleSend();
  }
});

// Auto-resize textarea
inputEl.addEventListener('input', function () {
  this.style.height = 'auto';
  this.style.height = Math.min(this.scrollHeight, 100) + 'px';
});
</script>

</body>
</html>
